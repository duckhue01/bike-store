 THIẾT KẾ CƠ SỞ DỮ LIỆU QUẢN LÍ CỬA HÀNG XE ĐẠP

I. TÓM TẮT CHỦ ĐỀ: 

	một ca hàng xe đạp có nhu  cầu quản lí những thông tin về nhân viên, đơn hàng, khách hàng, các loại xe mà cửa hàng bán, tên thương hiệu và số lượng từng loại sản phẩm trong kho.
Thiết kế một cơ sở dữ liệu để quản lí những thông tin trên và truy xuất khi cần thiết.

II. CHI TIẾT CÁC THỰC THỂ (TABLE):

TABLE SALES.STORES

	bảng sales.stores bao gồm các thông tin của cửa hàng. mỗi store chứa một store_name, thông tin liên lạc như là phone và email, và thông tin địa chỉ bao gồm street, city, state và zip_code.

CREATE TABLE sales.stores ( 
	store_id INT IDENTITY (1, 1) PRIMARY KEY, 
	store_name VARCHAR (255) NOT NULL, 
	phone VARCHAR (25), 
	email VARCHAR (255), 
	street VARCHAR (255), 
	city VARCHAR (255), 
	state VARCHAR (10), 
	zip_code VARCHAR (5) 
);

TABLE SALES.STAFFS

	bảng sales.staffs lưu trữ những thôn tin thiết yếu của nhân viên bao gồm first_name, last_name. Nó cũng chứa thông tin liên lạc như là email và phone.
	nhân viên làm tại cơ sở nào được xác định bởi giá trị trong store_id. Một cơ sở có thể có một hoặc nhiều nhân viên.
	một nhân viên có thể là quản lí của những nhân viên khác được xác đinh bởi thuộc tính manager_id. Nếu giá trị của manager_id là null thì nhân viên đó sẽ là nhân viên quản lí cấp cao nhất của cơ sở đó.
	Nếu một nhân viên không còn làm ở bất kì cơ sở nào nữa thì giá trị active sẽ là 0.


CREATE TABLE sales.staffs ( 
	staff_id INT IDENTITY (1, 1) PRIMARY KEY, 
	first_name VARCHAR (50) NOT NULL, 
	last_name VARCHAR (50) NOT NULL, 
	email VARCHAR (255) NOT NULL UNIQUE, 
	phone VARCHAR (25), 
	active tinyint NOT NULL, 
	store_id INT NOT NULL, 
	manager_id INT, 
	FOREIGN KEY (store_id) REFERENCES sales.stores (store_id) 
	ON DELETE CASCADE ON UPDATE CASCADE, 
	FOREIGN KEY (manager_id) REFERENCES sales.staffs (staff_id) 
	ON DELETE NO ACTION ON UPDATE NO ACTION 
);


TABLE PRODUCTION.CATEGORIES

	bảng production.categories lưu trữ các loại xe đạp như là: xe đạp điện, xe đạp trẻ em, xe leo núi ...


CREATE TABLE production.categories ( 
category_id INT IDENTITY (1, 1) PRIMARY KEY, 
category_name VARCHAR (255) NOT NULL 
);

tables production.brands

	bảng production.brands chứa thông tin thương hiệu của từng loại xe, ví dụ: Electra, Haro và Heller.

CREATE TABLE production.brands ( 
	brand_id INT IDENTITY (1, 1) PRIMARY KEY, 
	brand_name VARCHAR (255) NOT NULL 
);


TABLE PRODUCTION.PRODUCTS

	bảng production.products lữu trữ thông tin sản phẩm như là product_name, brand_id, category_id, model_year và list_price.

	mỗi sản phẩm thuộc về  một thương hiệu được sác đinh bởi brand_id. do đó, một thương hiệu có thể có một hoặc nhiều sản ph
	mỗi sản phẩm thuộc về một loại nào đó được xác đinh bởi category_id và mỗi loại có không hoặc nhiều sản phẩm.

CREATE TABLE production.products ( 
	product_id INT IDENTITY (1, 1) PRIMARY KEY, 
	product_name VARCHAR (255) NOT NULL, 
	brand_id INT NOT NULL, 
	category_id INT NOT NULL, 
	model_year SMALLINT NOT NULL, 
	list_price DECIMAL (10, 2) NOT NULL, 
	FOREIGN KEY (category_id) REFERENCES production.categories (category_id) 
	ON DELETE CASCADE ON UPDATE CASCADE, 
	FOREIGN KEY (brand_id) REFERENCES sales.brands (brand_id) 
	ON DELETE CASCADE ON UPDATE CASCADE 
);

TABLE SALES.CUSTOMERS

	bảng sales.customers chứa thông tin của kahcs hàng bao gồm first_name , last_name, phone, email, street, city, state v zip_code. 


CREATE TABLE sales.customers ( 
	customer_id INT IDENTITY (1, 1) PRIMARY KEY, 
	first_name VARCHAR (255) NOT NULL, 
	last_name VARCHAR (255) NOT NULL, 
	phone VARCHAR (25), 
	email VARCHAR (255) NOT NULL, 
	street VARCHAR (255), 
	city VARCHAR (50), 
	state VARCHAR (25), 
	zip_code VARCHAR (5) 
);

TABLE SALES.ORDERS

	bảng sales.order lưu trữ thông tin quan trọng của một đơn đặt hàng như là: customer_id, order_status, order_date, require_date, shipped date.
	
	bảng này cũng lưu trữ thông tin nơi giao dịch được tạo ra (store_id) và nhân viên tạo ra giao dịch đó (staff_id).
	

	mỗi đơn hàng sẽ là một hàng trong bảng sales.order. một đơn hàng sẽ có một hoặc nhiều sản phẩm được lưu trữ trong bảng sales.order_items.


CREATE TABLE sales.orders ( 
order_id INT IDENTITY (1, 1) PRIMARY KEY, 
customer_id INT, 
order_status tinyint NOT NULL,
 -- Order status: 1 = Pending; 2 = Processing; 3 = Rejected; 4 = Completed order_date DATE NOT NULL, 
required_date DATE NOT NULL, 
shipped_date DATE, 
store_id INT NOT NULL, 
staff_id INT NOT NULL, 
FOREIGN KEY (customer_id) REFERENCES sales.customers (customer_id) 
ON DELETE CASCADE ON UPDATE CASCADE, 
FOREIGN KEY (store_id) REFERENCES sales.stores (store_id) 
ON DELETE CASCADE ON UPDATE CASCADE, 
FOREIGN KEY (staff_id) REFERENCES sales.staffs (staff_id) 
ON DELETE NO ACTION ON UPDATE NO ACTION 
);

TABLE SALES.ORDER_ITEMS

	bảng sales.order_items chứa các thông tin chi tiết của sản phẩm trong bảng sales.orders. mỗi chi tiết sản phẩm thuộc về đơn hàng nào được xác đinh bơi thuộc tính order_id.
	
	một chi tiết sản phẩm bao gồm, product_id, quantity, list_price, discount


CREATE TABLE sales.order_items( 
order_id INT, 
item_id INT, 
product_id INT NOT NULL, 
quantity INT NOT NULL, 
list_price DECIMAL (10, 2) NOT NULL, 
discount DECIMAL (4, 2) NOT NULL DEFAULT 0, 
PRIMARY KEY (order_id, item_id), 
FOREIGN KEY (order_id) REFERENCES sales.orders (order_id) 
ON DELETE CASCADE ON UPDATE CASCADE, 
FOREIGN KEY (product_id) REFERENCES production.products (product_id) 
ON DELETE CASCADE ON UPDATE CASCADE 
);


TABLE PRODUCTION.STOCKS

	bảng production.stocks lưu trữ thông tin hàng tồn kho. số lượng sản phẩm cụ thể tồn tại trong kho









CREATE TABLE production.stocks ( 
	store_id INT, 
	product_id INT, 
	quantity INT, 
	PRIMARY KEY (store_id, product_id), 
	FOREIGN KEY (store_id) REFERENCES sales.stores (store_id) 
	ON DELETE CASCADE ON UPDATE CASCADE, 
	FOREIGN KEY (product_id) REFERENCES production.products (product_id) 
	ON DELETE CASCADE ON UPDATE CASCADE 
);


BIỂU ĐỒ THỰC THỂ LIÊN KẾT


giải thích kí hiệu:
